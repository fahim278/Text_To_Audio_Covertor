<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Text to Audio Downloader</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      max-width: 600px;
      margin: 40px auto;
      padding: 20px;
      background: #f4f7fa;
      color: #333;
    }
    h1 { text-align: center; color: #2c3e50; }
    textarea {
      width: 100%;
      height: 120px;
      padding: 12px;
      font-size: 16px;
      border: 2px solid #3498db;
      border-radius: 8px;
      margin-bottom: 15px;
    }
    button {
      background: #3498db;
      color: white;
      border: none;
      padding: 14px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
    }
    button:hover { background: #2980b9; }
    .status { margin-top: 15px; text-align: center; font-weight: bold; }
    .download { color: #27ae60; }
  </style>
</head>
<body>
  <h1>Text â†’ Audio (MP3 Download)</h1>
  <textarea id="textInput" placeholder="Type your text here... e.g., Opening browser..."></textarea>
  <button id="generateBtn">Generate & Download MP3</button>
  <div class="status" id="status"></div>

  <script>
    const API_KEY = "sk_72cbd9fc573c35d31d774233fd22e798353b9cfd91f9b767"; // Get free at: https://elevenlabs.io
    const VOICE_ID = "21m00Tcm4TlvDq8ikWAM"; // Rachel (clear, natural)

    document.getElementById("generateBtn").onclick = async () => {
      const text = document.getElementById("textInput").value.trim();
      const status = document.getElementById("status");
      
      if (!text) {
        status.innerHTML = "Please enter some text!";
        return;
      }

      status.innerHTML = "Generating audio...";
      status.className = "status";

      try {
        const response = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${VOICE_ID}`, {
          method: "POST",
          headers: {
            "xi-api-key": API_KEY,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            text: text,
            model_id: "eleven_monolingual_v1",
            voice_settings: { stability: 0.75, similarity_boost: 0.8 }
          })
        });

        if (!response.ok) throw new Error("API error");

        const audioBlob = await response.blob();
        const url = URL.createObjectURL(audioBlob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "voice_output.mp3";
        a.click();

        status.innerHTML = "Downloaded! <span class='download'>voice_output.mp3</span>";
      } catch (err) {
        console.error(err);
        status.innerHTML = "Failed. Trying browser voice...";
        fallbackTTS(text, status);
      }
    };

    // Fallback: Use browser's built-in TTS
    function fallbackTTS(text, status) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.onend = () => {
        status.innerHTML = "Playing in browser (no download)";
      };
      speechSynthesis.speak(utterance);
    }
  </script>
</body>
</html>